---
templateKey: blog-post
url: ts-js-symbol
title: JavascriptやTypescriptで登場するSymbol()って何だろう？と思って調べた話
date: 2022-01-27T19:00:00.000Z
description: >-
  JS,TS系のGithubリポジトリを眺めていてSymbol()という記述を見かけました。
  ライブラリのコアな部分で見かけたことはあるのですが、いまいち使い方が分かっていなかったので調べてみました。
featuredpost: false
featuredimage: /img/js.png
tags:
  - javascript
  - typescript
---

## まずは公式を見る
まずは説明を読んでみましょう。
- [MDN - Symbol](https://js.studio-kingdom.com/typescript/handbook/symbols)
- [Typescript日本語ハンドブック - シンボル](https://js.studio-kingdom.com/typescript/handbook/symbols)

> データ型 symbol は、プリミティブデータ型です。Symbol() 関数は、symbol 型の値を返します。これは組み込みオブジェクトを公開するための静的プロパティを持ち、グローバルシンボルレジストリを公開するための静的メソッドを持つので、組み込みオブジェクトクラスのようにも見えますが、コンストラクターとしての機能を持たず、"new Symbol()" はサポートされていません。

うーん、分かったようなそうでもないような。

こんな記述もあります。
> Symbol() から返されるすべてのシンボル値は一意です。シンボル値は、オブジェクトプロパティの識別子として使用できます。

ポイントはこの記述で、要は任意のオブジェクトのプロパティを作れるということです。

```ts
const HOGE = Symbol('hoge');

const obj = {
  [HOGE]: 'hogehoge'
};
```

## 通常のプロパティと何が違う？
上記のコードだけを見ると「別に`hoge`というプロパティを作ればいいじゃん」と思うかもしれません。

```ts
// これと何が違う？
const obj = {
  hoge: 'hogehoge'
};
```

## 通常のプロパティだと困るケース
例えば以下のようなレスポンスのAPIを想定します。
記事一覧を返してくれるようなAPIです。

```ts
const articleList = [
    {no: 1001, title: "hoge"},
    {no: 3004, title: "fuga"},
    {no: 5005, title: "puni"}
]
```

`no`はAPIの提供元で割り振られたものですが、自作アプリケーションのために`id`というプロパティを割り振ることを考えます。

```ts
// articleに任意のidの値を追加して返却する
const addId = (article) => {
    return {
        ...article,
        id : Math.floor( Math.random() * 100000 )
    }
}

// APIから取得してきたデータにidを追加する
const processedArticleList = articleList.map(article => addId(article));
```

当面はこれで問題なく動作していました。
しかしながら後になってAPIの仕様が変更となり、`API`のレスポンスで「今まで`no`だったプロパティ名が`id`に変更になった」場合はどうでしょうか？

```ts
// API仕様変更に伴いnoがidになった
const articleList = [
    {id: 1001, title: "hoge"},
    {id: 3004, title: "fuga"},
    {id: 5005, title: "puni"}
];

// articleに任意のidの値を追加して返却する
const addId = (article) => {
    return {
        ...article,
        id : Math.floor( Math.random() * 100000 )
    }
}

// APIから取得してきたデータにidを追加する
const processedArticleList = articleList.map(article => addId(article));
```

この場合、元々レスポンスに含まれていた`id`のプロパティを`addId`が上書きしてしまうことになります。
慌てて`addId`で付与するプロパティ名を`customId`などに変えましたが、影響範囲が膨大になってしまったり・・・

## Symbolは他と重複しないプロパティである
こういったことを`Symbol()`なら防ぐことができます。
`Syombol()`は平たく説明すると「アプリケーション独自の重複しない定数プロパティ」です。

```ts
const id = Symbol('id');

// 共存できる
const obj = {
  [id]: 'hogehoge',
  id: 'fugafuga'
}

console.log(obj[id]); // --> hogehoge
console.log(obj.id); // --> fugafuga
```

